{% extends "base.html" %}

{% block title %}Dashboard - Sport Room Booking{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Welcome, {{ current_user.username }}!</h2>
        <div>
          <a href="{{ url_for('main.index') }}" class="btn btn-primary">
            <i class="bi bi-map"></i> View 3D Campus Map
          </a>
          <a href="{{ url_for('booking.my_bookings') }}" class="btn btn-outline-primary">
            <i class="bi bi-calendar-check"></i> My Bookings
          </a>
        </div>
      </div>
    </div>
  </div>

  <div class="row g-4">
    <!-- Quick Stats -->
    <div class="col-md-4">
      <div class="card bg-primary text-white">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <h6 class="card-title">Available Buildings</h6>
              <h3>{{ buildings|length }}</h3>
            </div>
            <div class="align-self-center">
              <i class="bi bi-building display-6"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card bg-success text-white">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <h6 class="card-title">Sports Facilities</h6>
              <h3>4</h3>
              <small>Ready to book</small>
            </div>
            <div class="align-self-center">
              <i class="bi bi-trophy display-6"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card bg-info text-white">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <h6 class="card-title">Your Role</h6>
              <h3>{{ current_user.role.title() }}</h3>
            </div>
            <div class="align-self-center">
              <i class="bi bi-person-badge display-6"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="row mt-4">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h5><i class="bi bi-lightning"></i> Quick Actions</h5>
        </div>
        <div class="card-body">
          <div class="row g-3">
            <div class="col-md-6 col-lg-3">
              <a href="{{ url_for('main.index') }}" class="btn btn-outline-primary w-100 p-3">
                <i class="bi bi-map display-6 mb-2"></i><br>
                <strong>3D Campus Map</strong><br>
                <small>Explore and book facilities</small>
              </a>
            </div>

            <div class="col-md-6 col-lg-3">
              <a href="{{ url_for('booking.my_bookings') }}" class="btn btn-outline-success w-100 p-3">
                <i class="bi bi-calendar-check display-6 mb-2"></i><br>
                <strong>My Bookings</strong><br>
                <small>View booking history</small>
              </a>
            </div>

            {% if current_user.is_admin() %}
            <div class="col-md-6 col-lg-3">
              <a href="{{ url_for('admin.admin_dashboard') }}" class="btn btn-outline-warning w-100 p-3">
                <i class="bi bi-gear display-6 mb-2"></i><br>
                <strong>Admin Panel</strong><br>
                <small>Manage system</small>
              </a>
            </div>

            <div class="col-md-6 col-lg-3">
              <a href="{{ url_for('admin.manage_bookings') }}" class="btn btn-outline-danger w-100 p-3">
                <i class="bi bi-clipboard-check display-6 mb-2"></i><br>
                <strong>Approve Bookings</strong><br>
                <small>Review requests</small>
              </a>
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Buildings List -->
  <div class="row mt-4">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h5><i class="bi bi-building"></i> Campus Buildings</h5>
        </div>
        <div class="card-body">
          <div class="row g-3">
            {% for building in buildings %}
            <div class="col-md-6 col-lg-4">
              <div class="card h-100">
                {% if building.image_url %}
                <img src="{{ building.image_url }}" class="card-img-top" alt="{{ building.name }}"
                  style="height: 150px; object-fit: cover;">
                {% else %}
                <div class="card-img-top bg-secondary d-flex align-items-center justify-content-center"
                  style="height: 150px;">
                  <i class="bi bi-building display-4 text-white"></i>
                </div>
                {% endif %}
                <div class="card-body">
                  <h6 class="card-title">{{ building.name }}</h6>
                  <p class="card-text">
                    <small class="text-muted">Code: {{ building.code }}</small><br>
                    {{ building.description or 'Campus building' }}
                  </p>
                </div>
                <div class="card-footer">
                  <a href="{{ url_for('main.view_building', building_id=building.id) }}" class="btn btn-sm btn-primary">
                    <i class="bi bi-eye"></i> View Details
                  </a>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}